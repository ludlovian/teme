!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.teme=t()}(this,function(){function n(){}var t="map,scan,dedupe,dedupeWith,when,throttle,debounce".split(","),e=["changed"],r=function(r){var o=this;this.value=r,this.notify=new Set,this.detacher=n,this.fn=this.update.bind(this),this.fn.stream=this,t.forEach(function(n){o.fn[n]=function(){for(var t,e=[],r=arguments.length;r--;)e[r]=arguments[r];return(t=o)[n].apply(t,e).fn}}),e.forEach(function(n){o.fn[n]=function(){for(var t,e=[],r=arguments.length;r--;)e[r]=arguments[r];return(t=o)[n].apply(t,e)}})};function o(n){return function(){return n.forEach(function(n){return n()})}}function u(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];var e=r.create.apply(r,n);return e.addEnd(),e.fn}function i(n,t){return n===t}return r.create=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return new(Function.prototype.bind.apply(r,[null].concat(n)))},r.prototype.subscribe=function(n){var t=this;return this.notify.add(n),function(){return t.notify.delete(n)}},r.prototype.endStream=function(){this.notify.clear(),this.detacher(),this.detacher=n},r.prototype.addEnd=function(){var n=this;this.end=r.create(),this.end.subscribe(function(){n.end.endStream(),n.endStream()}),this.fn.end=this.end.fn},r.prototype.update=function(n){0!==arguments.length&&(this.value=n,Array.from(this.notify).forEach(function(t){return t(n)}));return this.value},r.combine=function(n,t,e){var u=r.create(e);return u.detacher=o(t.map(function(e){return e.subscribe(function(){var r=n.apply(void 0,t.concat([u],[[e]]));null!=r&&u.update(r)})})),u.addEnd(),u.end.detacher=o(t.map(function(n){return n.end.subscribe(function(n){return u.end.update(n)})})),u},r.prototype.map=function(n,t){return r.combine(function(t){return n(t.value)},[this],t)},r.prototype.dedupeWith=function(n){var t;return r.combine(function(e,r){var o=e.value;n(t,o)||r.update(o),t=o},[this])},r.prototype.dedupe=function(){return this.dedupeWith(i)},r.merge=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return r.combine(function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];var e=n.pop(),r=n.pop();e.forEach(function(n){return r.update(n.value)})},n)},r.prototype.scan=function(n,t){return this.map(function(e){return t=n(t,e)},t)},r.prototype.when=function(n){var t,e,r=function(){return new Promise(function(n){t=n})},o=r();return n(this.value)&&(e=!0,t()),this.scan(function(o,u){return n(u)?e||(e=!0,t()):e&&(e=!1,o=r()),o},o)},r.prototype.changed=function(){var n=this;return new Promise(function(t){var e=n.map(function(n){t(n),e.end.update(!0)})})},r.prototype.throttle=function(n){var t,e,o=this,u=function(){c.update(o.value),e=!1},i=function(){return setTimeout(function(){e?(u(),t=i()):t=null},n)},c=r.combine(function(){t?e=!0:(u(),t=i())},[this]);return c},r.prototype.debounce=function(n){var t,e=this,o=function(){u.update(e.value),t=null},u=r.combine(function(){t&&clearTimeout(t),t=setTimeout(o,n)},[this]);return u},Object.assign(u,{combine:function(n,t,e){return r.combine(function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=t.pop(),o=t.pop();return n.apply(void 0,t.map(function(n){return n.fn}).concat([o.fn],[r.map(function(n){return n.fn})]))},t.map(function(n){return n.stream}),e).fn},merge:function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return r.merge.apply(r,n.map(function(n){return n.stream})).fn}}),u});
//# sourceMappingURL=index.umd.js.map
